---
title: "Final"
format: html
author: Evan Cooper
date: 6/06/25
toc: TRUE
toc-title: Table of Contents
toc-location: left
execute: 
  warning: FALSE
  message: FALSE
---

[Github Repository](https://github.com/cooperevan/ENVS-193DS_spring-2025_final.git)

```{r}
#read in packages
library(tidyverse)
library(janitor)
library(dplyr)
library(PNWColors)
library(gt)
library(MuMIn)
library(DHARMa)
```

\[Rendered Output\]

# Problem 1. Research Writing

## a. Transparent statistical methods

In part one, they used a pearson correlation test, with the word "correlation" as evidence of so. In part two, they used a one-way ANOVA since there are multiple groups they are testing for one factor or variable, nitrogen load.

## b. More info needed

If you use an ANOVA test, you'll know that two groups are different, but you won't know which ones are different. Two things that could be included to add context to the anova is an F statistic, which is used to evaluate significance and helps us find our p-value to determine if we should reject or accept the null. Another important test to include is a shapiro-wilks normality test, to determine normality which is important since the assumption of an anova requires a normal distribution of the variables.

## c. Suggestions for rewriting

The average load of nitrogen in kg per year is significant between sources (urban land, atmospheric deposition, fertilizer, wastewater treatment, and grasslands) (one-way ANOVA, F = F distribution, df = degrees of freedom, p = 0.02). Sites located farther from from the headwaters have a higher annual total nitrogen load than those closer (Pearson correlation test, r = correlation coefficient, p = 0.03, a = significance level, n = sample size).

# Problem 2. data visualization

```{r}
#read in data
sst <- read.csv("/Users/evancooper/Desktop/GitHub/ENVS-193DS_spring-2025_final/data/SST_update2023.csv")
```

## a. Cleaning and Summarizing

```{r}
#clean and wrangle
sst_clean <- sst |> #change df
  clean_names() |> 
  mutate(year = year(date),
         month = month(date),
         month = month(date, label = TRUE, abbr = TRUE)) |> #get month and year in seperate column
  select(year, month, temp) |>
  filter(year %in% 2018:2023) |> 
  group_by(year, month) |> 
  summarize(mean_monthly_sst = mean(temp)) #find mean of sst and make column

sst_clean |> 
  slice_sample(n = 5) #show 5 columns

# Show structure
str(sst_clean)
```

## b. Visualize the Data

```{r}
#visualize
sst_clean |> 
  filter(year %in% 2018:2023) |>
  mutate(year = factor(year)) |> 
ggplot(aes(x = month,
           y = mean_monthly_sst,
           color = year,
           group = year))+
  geom_point()+
  geom_line()+
  labs(x = "Month",
       y = "Mean monthly sea surface temperature (°C)") +
  theme_minimal()+
  scale_color_manual(values = pnw_palette("Starfish", 6))+
  theme(
    legend.position = c(0.2, 0.7),
    panel.grid = element_blank(),
    axis.line = element_line(color = "grey50"))
```

# Problem 3. Data Analysis

## a. Response variable

```{r}
nest_boxes <- read.csv("/Users/evancooper/Desktop/GitHub/ENVS-193DS_spring-2025_final/data/occdist.csv") |> 
  clean_names()
```

The ones and zeros in the data sheet mean that the nest was either occupied or unoccupied by that species, the common starling, tree martin, parrot, or empty.

## b. Purpose of study

Swift parrots are native and at risk of extinction in Australia. They also rarely nest in the same area twice, meaning there's competition with other species. Tree martins and Starlings are competitors to Swift Parrots. While there is no study of the aggressiveness of swift parrots, the authors have seen starlings destroy swift parrot eggs.

## c. Difference in “seasons”

The seasons are the summer breeding season of 2016 and 2019, the first is when the nest boxes were first deployed, and 2019 when they were established.

## d. Table of models

4 models total:

| Model number | Season | Distance to forest edge | Model description |
|:------------:|:------:|:-----------------------:|:-----------------:|
|      1       |        |                         |    Null Model     |
|      2       |   X    |                         |   Season Model    |
|      3       |        |            X            |     DFE Model     |
|      4       |   X    |            X            |  Saturated Model  |

```{r}
clean_data <- nest_boxes |> 
  select(box, season, edge_distance, box_occupant) |> 
  mutate(box_occupant = as_factor(box_occupant)) 
  str(clean_data)
  slice_sample(clean_data, n = 10)
```

## e. Run the models (8 points)

Write your code to run all your models. Do not display any output.

```{r, include=FALSE}
model1 = lm(
  sp ~ 1,
  data = nest_boxes
)

model2 = lm(
  sp ~ 1 + season,
  data = nest_boxes
)

model3 = lm(
  sp ~ 1 + edge_distance,
  data = nest_boxes
)

model4 = lm(
  sp ~ 1 + edge_distance + season,
  data = nest_boxes
)
```

## f. Check the diagnostics (6 points)

Check your diagnostics for all models using simulated residuals from the `DHARMa` package.

Display the diagnostic plots for each model.

```{r}
par(mfrow = c(2,2))
plot(model1)
plot(model2)
plot(model3)
plot(model4)
```

## g. Select the best model (6 points)

Using Akaike’s Information Criterion (AIC) from the `MuMIn` package, choose the best model.

In text, write what the best model was (i.e. “The best model as determined by Akaike’s Information Criterion (AIC)…”).

Use the predictors and the response variable to describe the model, not the model number that you assigned.

## h. Visualize the model predictions (24 points)

Create a plot showing model predictions with 95% confidence intervals and the underlying data.

Show and annotate all code. Show the output.

For full credit:

-   make sure the x- and y-axis labels are written in full

-   take out the gridlines

-   use colors that are different from the default

## i. Write a caption for your figure. (7 points)

Include a figure number, title, description of the figure, and data citation.

## j. Calculate model predictions (4 points)

Calculate the predicted probabilities of Swift Parrot nest box occupancy with 95% at 0 m from forest edge and 900 m from forest edge for each level in `season`.

Show and annotate all code. Display the output.

## k. Interpret your results (16 points)

Write 3-5 sentences summarizing what you found, making references to the figure you made in part h and the predictions you calculated in part j. Your summary should include your interpretation of:

-   the predicted probability of occupancy at the forest edge (0 m) and farther away from the forest edge (900 m) between seasons

-   the relationship between distance from forest edge and probability of occupancy

-   the biology behind the trends you found - what explains the relationship between distance from forest edge and probability of Swift Parrot nest box occupancy?

# Problem 4. Affective and exploratory visualizations

## a. compare and contrast

![Exploratory Visualization](images/5DC2FDE4-F331-418D-8405-D6130DFD688B.png){fig-align="left" width="600"}

In my exploratory data set I started off by comparing my workout ***duration*** to hours of sleep, while my affective visual compares workout ***type*** to hours asleep. The only similarity is the large standard deviation between exercises, due to the low number of observations.

Patterns in the visualization that are consistent are the push and rest days having the most sleep. Its hard to see trends in the data since the exploratory visualization is missing points and isn't focused on the mean of the data, while the affective visualization showcases the mean with the ridges.

Advice I gathered from my peers was how simple the data was to follow and easy to digest for my affective visualization which I chose not to over-complicate with more data.

![Affective visual](images/workout_plot.png){fig-align="right" width="600"}

## b. Share Affective Visual

::: callout-note
## Thank you

I wanted to thank you for help this quarter, I truly feel like I learned an insane amount of coding. I did my best to knock the final out of the park in order to show that even with a few of stumbles I still had the capability to succeed in the class.
:::
